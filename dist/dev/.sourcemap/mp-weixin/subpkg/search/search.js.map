{"version":3,"file":"subpkg/search/search.js","mappings":"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","sources":["webpack:///./src/subpkg/search/search.vue?94d1","webpack:///./src/subpkg/search/search.vue?5790","webpack:///./src/subpkg/search/search.vue?fd91","webpack:///./src/subpkg/search/search.vue?a9a5","webpack:///./src/subpkg/search/search.vue?b21a","uni-app:///src/main.js","uni-app:///src/subpkg/search/search.vue","webpack:///./src/subpkg/search/search.vue?bc5b"],"sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./search.vue?vue&type=template&id=1480e53a&\"\nvar renderjs\nimport script from \"./search.vue?vue&type=script&lang=js&\"\nexport * from \"./search.vue?vue&type=script&lang=js&\"\nimport style0 from \"./search.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"subpkg/search/search.vue\"\nexport default component.exports","export * from \"-!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??clonedRuleSet-42[0].rules[0].use[0]!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search.vue?vue&type=template&id=1480e53a&\"","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[0]!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[0]!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search.vue?vue&type=script&lang=js&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-22[0].rules[0].use[0]!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[1]!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??clonedRuleSet-22[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[3]!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[4]!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??clonedRuleSet-22[0].rules[0].use[5]!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-22[0].rules[0].use[0]!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[1]!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??clonedRuleSet-22[0].rules[0].use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[3]!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??clonedRuleSet-22[0].rules[0].use[4]!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??clonedRuleSet-22[0].rules[0].use[5]!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search.vue?vue&type=style&index=0&lang=scss&\"","var components\ntry {\n  components = {\n    uniSearchBar: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/@dcloudio/uni-ui/lib/uni-search-bar/uni-search-bar\" */ \"@dcloudio/uni-ui/lib/uni-search-bar/uni-search-bar.vue\"\n      )\n    },\n    uniIcons: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/@dcloudio/uni-ui/lib/uni-icons/uni-icons\" */ \"@dcloudio/uni-ui/lib/uni-icons/uni-icons.vue\"\n      )\n    },\n    uniTag: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/@dcloudio/uni-ui/lib/uni-tag/uni-tag\" */ \"@dcloudio/uni-ui/lib/uni-tag/uni-tag.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './subpkg/search/search.vue'\ncreatePage(Page)","<template>\r\n  <view>\r\n    <view class=\"search-box\">\r\n      <uni-search-bar\r\n        @input=\"input\"\r\n        :radius=\"100\"\r\n        cancelButton=\"none\"\r\n        :placeholder=\"'请输入搜索内容'\"\r\n        :focus=\"true\"\r\n      >\r\n      </uni-search-bar>\r\n    </view>\r\n    <view class=\"sugg-list\" v-show=\"kw\">\r\n      <view\r\n        v-for=\"(item, i) in searchResults\"\r\n        :key=\"i\"\r\n        class=\"sugg-item\"\r\n        @click=\"gotoDetail(item)\"\r\n      >\r\n        <uni-icons type=\"search\" size=\"16\" class=\"sugg-item-search\"></uni-icons>\r\n        <view class=\"goods-name\">{{ item.goods_name }}</view>\r\n      </view>\r\n    </view>\r\n    <view class=\"history-box\" v-show=\"!kw\">\r\n      <view class=\"history-title\">\r\n        <text>搜索历史</text>\r\n        <uni-icons type=\"trash\" size=\"16\" @click=\"cleanHistory\"></uni-icons>\r\n      </view>\r\n      <view class=\"history-list\">\r\n        <uni-tag\r\n          custom-style=\"background-color: #efefef; color: #000; border-color: #efefef\"\r\n          v-for=\"(item, i) in historyList\"\r\n          :key=\"i\"\r\n          :text=\"item\"\r\n          @click=\"gotoGoodsList(item)\"\r\n        >\r\n        </uni-tag>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 延时器的timerId\r\n      timer: null,\r\n      // 搜索关键词\r\n      kw: \"\",\r\n      // 搜索结果数据列表\r\n      searchResults: [],\r\n      // 搜索关键词的历史记录\r\n      historyList: [],\r\n    };\r\n  },\r\n  methods: {\r\n    // 输入事件的处理函数\r\n    input(e) {\r\n      // 清除 timer 对应的延时器\r\n      clearTimeout(this.timer);\r\n      // 重新启动一个延时器，并把 timerId 赋值给this.timer\r\n      this.timer = setTimeout(() => {\r\n        // 如果 500 毫秒内，没有触发新的输入事件，则为搜索关键词赋值\r\n        this.kw = e;\r\n        this.getSearchResults();\r\n      }, 1000);\r\n    },\r\n    async getSearchResults() {\r\n      if (this.kw.trim() === \"\") {\r\n        this.searchResults = [];\r\n        return;\r\n      }\r\n\r\n      const { data: res } = await uni.$http.get(\r\n        \"/api/public/v1/goods/qsearch\",\r\n        {\r\n          query: this.kw,\r\n        }\r\n      );\r\n\r\n      if (res.meta.status != 200) return uni.$showMsg();\r\n      this.searchResults = res.message;\r\n\r\n      // 保存搜索关键词\r\n      this.saveSearchHistory();\r\n    },\r\n    gotoDetail(item) {\r\n      uni.navigateTo({\r\n        url: \"/subpkg/goods_detail/goods_detail?goods_id=\" + item.goods_id,\r\n      });\r\n    },\r\n    saveSearchHistory() {\r\n      if (this.historyList.includes(this.kw)) {\r\n        const indexToRemove = this.historyList.indexOf(this.kw)\r\n        this.historyList.splice(indexToRemove, 1);\r\n        this.historyList.unshift(this.kw);\r\n      } else {\r\n        this.historyList.unshift(this.kw);\r\n      }\r\n      uni.setStorageSync('search_history', JSON.stringify(this.historyList))\r\n    },\r\n    cleanHistory() {\r\n      this.historyList = []\r\n      uni.setStorageSync('search_history', JSON.stringify(this.historyList))\r\n    },\r\n    gotoGoodsList(kw) {\r\n      uni.navigateTo({\r\n        url: '/subpkg/goods_list/goods_list?query=' + kw\r\n      })\r\n    }\r\n  },\r\n  onLoad() {\r\n    this.historyList = JSON.parse(uni.getStorageSync('search_history') || '[]')\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.uni-searchbar {\r\n  background-color: #ff0000;\r\n}\r\n\r\n.search-box {\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 999;\r\n}\r\n\r\n.sugg-list {\r\n  padding: 0 5px;\r\n\r\n  .sugg-item {\r\n    display: flex;\r\n    padding: 13px 0;\r\n    font-size: 12px;\r\n    border-bottom: 1px solid #efefef;\r\n    align-items: center;\r\n\r\n    .sugg-item-search {\r\n      margin-right: 5px;\r\n    }\r\n\r\n    .goods-name {\r\n      white-space: nowrap;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n  }\r\n}\r\n\r\n.history-box {\r\n  padding: 0 5px;\r\n\r\n  .history-title {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    height: 40px;\r\n    align-items: center;\r\n    font-size: 13px;\r\n    border-bottom: 1px solid #efefef;\r\n  }\r\n\r\n  .history-list {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    margin-top: 5px;\r\n\r\n    .uni-tag {\r\n      margin-top: 5px;\r\n      margin-right: 5px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","// extracted by mini-css-extract-plugin"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","Vue","Page","createPage","data","timer","kw","searchResults","historyList","methods","input","e","_this","clearTimeout","setTimeout","getSearchResults","_this2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$uni$$http$get","res","wrap","_callee$","_context","prev","next","trim","abrupt","uni","$http","get","query","sent","meta","status","$showMsg","message","saveSearchHistory","stop","gotoDetail","item","navigateTo","url","goods_id","includes","indexToRemove","indexOf","splice","unshift","setStorageSync","JSON","stringify","cleanHistory","gotoGoodsList","onLoad","parse","getStorageSync"],"sourceRoot":""}